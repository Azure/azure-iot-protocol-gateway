<?xml version="1.0" encoding="utf-8"?>
<ServiceConfiguration serviceName="Contoso.ProtocolGateway" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceConfiguration" osFamily="4" osVersion="*" schemaVersion="2015-04.2.6">
  <Role name="Gateway.Samples.Cloud.Host">
    <Instances count="2" />
    <ConfigurationSettings>
      <!-- bridge settings -->
      <Setting name="IoTHub.ConnectionString" value="[parameters('iotHubConnectionString')]" />
      <Setting name="MaxOutstandingOutboundMessages" value="10" />
      <Setting name="DeviceReceiveAckTimeout" value="00:01:00" />
      <Setting name="MaxRetransmissionCount" value="2" />
      <!-- mqtt driver settings -->
      <Setting name="DefaultPublishToClientTopicName" value="messages/devicebound" />
      <Setting name="ConnectArrivalTimeout" value="00:01:00" />
      <Setting name="MaxKeepAliveTimeout" value="00:10:00" />
      <Setting name="DefaultPublishToClientQoS" value="1" />
      <Setting name="IoTHub.RetainProperty" value="mqtt-retain" />
      <Setting name="IoTHub.TopicNameProperty" value="mqtt-topic-name" />
      <Setting name="IoTHub.DupProperty" value="mqtt-dup" />
      <Setting name="IoTHub.QoSProperty" value="mqtt-qos" />
      <!-- cloud based MQTT session state manager settings -->
      <Setting name="SessionStateManager.StorageConnectionString" value="DefaultEndpointsProtocol=https;AccountName=[parameters('storageAccountName')];AccountKey=[parameters('storageAccountKey')]" />
      <Setting name="SessionStateManager.StorageContainerName" value="mqtt-sessions" />
      <!-- bootstrapper settings -->
      <Setting name="MaxInboundMessageSize" value="262144" />
      <!-- Azure settings -->
      <Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" value="DefaultEndpointsProtocol=https;AccountName=[parameters('storageAccountName')];AccountKey=[parameters('storageAccountKey')]" />
      <Setting name="TlsCertificateThumbprint" value="[parameters('tlsCertficateThumbprint')]" />
    </ConfigurationSettings>
    <Certificates>
      <Certificate name="TlsCertificate" thumbprint="0000000000000000000000000000000000000000" thumbprintAlgorithm="sha1" />
    </Certificates>
  </Role>
</ServiceConfiguration>